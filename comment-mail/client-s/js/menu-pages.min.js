(function(b){var a={},d=b(window),c=b(document);a.onReady=function(){var f="comment_mail",n="comment-mail",h=b("."+n+"-menu-page"),i=b("."+n+"-menu-page-area"),l=b("."+n+"-menu-page-table"),j=b("."+n+"-menu-page-form"),k=window[f+"_vars"],o=window[f+"_i18n"],g={search_contains:true,disable_search_threshold:10,allow_single_deselect:true};i.find("[data-pmp-action]").on("click",function(r){r.preventDefault(),r.stopImmediatePropagation();var q=b(this),p=q.data();if(typeof p.pmpConfirmation!=="string"||confirm(p.pmpConfirmation)){location.href=p.pmpAction}});h.find(".pmp-panels-open").on("click",function(){h.find(".pmp-panel-heading").addClass("open").next(".pmp-panel-body").addClass("open")});h.find(".pmp-panels-close").on("click",function(){h.find(".pmp-panel-heading").removeClass("open").next(".pmp-panel-body").removeClass("open")});h.find(".pmp-panel-heading").on("click",function(p){p.preventDefault(),p.stopImmediatePropagation();b(this).toggleClass("open").next(".pmp-panel-body").toggleClass("open")});h.find('select[name$="_enable\\]"], select[name$="_enable_flavor\\]"]').not(".no-if-enabled").on("change",function(){var s=b(this),q=s[0].name,p=s.val(),r=s.closest(".pmp-panel");if((q.indexOf("_enable]")!==-1&&(p===""||p==="1"))||(q.indexOf("_flavor]")!==-1&&p!=="0")){r.find(".pmp-panel-if-enabled").css("opacity",1).find(":input").removeAttr("readonly")}else{r.find(".pmp-panel-if-enabled").css("opacity",0.4).find(":input").attr("readonly","readonly")}}).trigger("change");l.find("> form").on("submit",function(){var t=b(this),q=t.find("#bulk-action-selector-top"),s=t.find("#bulk-action-selector-bottom"),r=q.val(),p=s.val();if(r==="reconfirm"||p==="reconfirm"){return confirm(o.bulk_reconfirm_confirmation)}else{if(r==="delete"||p==="delete"){return confirm(o.bulk_delete_confirmation)}}return true});var e={$select:j.find("> form tr.pmp-sub-form-post-id select"),$input:j.find("> form tr.pmp-sub-form-post-id input"),progress:'<img src="'+k.pluginUrl+'/client-s/images/tiny-progress-bar.gif" />'};if(e.$select.length){e.lastId=b.trim(e.$select.val())}else{e.lastId=b.trim(e.$input.val())}e.handler=function(){var q=b(this),r={},p={};e.newId=b.trim(q.val());if(e.newId===e.lastId){return}e.lastId=e.newId;r.$lastRow=j.find("> form tr.pmp-sub-form-comment-id"),r.$lastChosenContainer=r.$lastRow.find(".chosen-container"),r.$lastInput=r.$lastRow.find(":input");if(!r.$lastRow.length||!r.$lastInput.length){return}r.$lastChosenContainer.remove(),r.$lastInput.replaceWith(b(e.progress));p[f]={sub_form_comment_id_row_via_ajax:{post_id:e.newId}},b.get(k.ajaxEndpoint,p,function(s){r.$newRow=b(s),r.$lastRow.replaceWith(r.$newRow),r.$newRow.find("select").chosen(g)})};var m={$select:j.find("> form tr.pmp-sub-form-user-id select"),$input:j.find("> form tr.pmp-sub-form-user-id input"),$progress:b('<img src="'+k.pluginUrl+'/client-s/images/tiny-progress-bar.gif" />')};if(m.$select.length){m.lastId=b.trim(m.$select.val())}else{m.lastId=b.trim(m.$input.val())}m.handler=function(){var u=b(this),t,p,r,v,s,q={};m.newId=b.trim(u.val());if(m.newId===m.lastId){return}m.lastId=m.newId;t=j.find("> form tr.pmp-sub-form-email th"),p=j.find("> form tr.pmp-sub-form-email input"),r=j.find("> form tr.pmp-sub-form-fname input"),v=j.find("> form tr.pmp-sub-form-lname input"),s=j.find("> form tr.pmp-sub-form-insertion-ip input");if(!t.length||(p.length+r.length+v.length)<1){return}m.$progress.remove(),t.append(m.$progress);q[f]={sub_form_user_id_info_via_ajax:{user_id:m.newId}},b.get(k.ajaxEndpoint,q,function(w){p.val(w.email),r.val(w.fname),v.val(w.lname),s.val(w.ip);m.$progress.remove()})};e.$select.on("change",e.handler).chosen(g),e.$input.on("blur",e.handler);j.find("> form tr.pmp-sub-form-comment-id select").chosen(g);m.$select.on("change",m.handler).chosen(g),m.$input.on("blur",m.handler);j.find("> form tr.pmp-sub-form-status select").on("change",function(){var s=b(this),p=b.trim(s.val()),q=s.siblings(".checkbox"),r=q.find("input");if(p==="unconfirmed"){q.show()}else{r.prop("checked",false),q.hide()}}).trigger("change").chosen(g);j.find("> form tr.pmp-sub-form-deliver select").chosen(g);j.find("> form").on("submit",function(r){var q=b(this),s="",p=[];q.find(".form-required :input[required]").each(function(){var t=b(this),u=b.trim(t.val());if(typeof u==="undefined"||u==="0"||u===""){p.push(this)}});b.each(p,function(){s+=b.trim(q.find('label[for="'+this.id+'"]').text().replace(/\s+/g," "))+"\n"});if((s=b.trim(s)).length){r.preventDefault(),r.stopImmediatePropagation(),alert(s);return false}})};c.ready(a.onReady)})(jQuery);